import{a as pt,c as ft}from"./index-DUduwWLC.js";import{r as gt}from"./froala_editor.min-CYTjCKNx.js";function ct(re,de){for(var l=0;l<de.length;l++){const k=de[l];if(typeof k!="string"&&!Array.isArray(k)){for(const L in k)if(L!=="default"&&!(L in re)){const W=Object.getOwnPropertyDescriptor(k,L);W&&Object.defineProperty(re,L,W.get?W:{enumerable:!0,get:()=>k[L]})}}}return Object.freeze(Object.defineProperty(re,Symbol.toStringTag,{value:"Module"}))}var dt={exports:{}};/*!
 * froala_editor v4.5.0 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2025 Froala Labs
 */(function(re,de){(function(l,k){k(gt())})(ft,function(l){function k(e,r){(r==null||r>e.length)&&(r=e.length);for(var g=0,h=Array(r);g<r;g++)h[g]=e[g];return h}function L(e,r){var g=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!g){if(Array.isArray(e)||(g=function(D,V){if(D){if(typeof D=="string")return k(D,V);var _={}.toString.call(D).slice(8,-1);return _==="Object"&&D.constructor&&(_=D.constructor.name),_==="Map"||_==="Set"?Array.from(D):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?k(D,V):void 0}}(e))||r){g&&(e=g);var h=0,S=function(){};return{s:S,n:function(){return h>=e.length?{done:!0}:{done:!1,value:e[h++]}},e:function(O){throw O},f:S}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var E,F=!0,f=!1;return{s:function(){g=g.call(e)},n:function(){var O=g.next();return F=O.done,O},e:function(O){f=!0,E=O},f:function(){try{F||g.return==null||g.return()}finally{if(f)throw E}}}}function W(e){return(W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(e)}l=l&&l.hasOwnProperty("default")?l.default:l,Object.assign(l.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),Object.assign(l.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageCaption","imageRemove","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUpload:!0,imageUploadURL:null,imageCORSProxy:"https://cors-anywhere.froala.com",imageUploadRemoteUrls:!0,imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadToAzure:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif","webp"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered","fr-shadow":"Shadow"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5,imageAddNewLine:!1}),l.IMAGE_ALLOW_REGEX=/\.(gif|jpe?g|tiff?|png|webp|bmp)$/i,l.PLUGINS.image=function(e){var r,g,h,S,E,F,f=e.$,O="https://i.froala.com/upload",D=!1,V=1,_=2,Re=3,X=4,Ue=5,me=6,I={};function Fe(){var t=e.popups.get("image.insert").find(".fr-image-by-url-layer input");t.val(""),r&&t.val(r.attr("src")),t.trigger("change")}function xe(t){return window.pageYOffset+t.get(0).getBoundingClientRect().top}function j(){var t=e.popups.get("image.edit");if(t||(t=ve()),t){var a=r;e.popups.setContainer("image.edit",e.$wp||e.$sc),e.popups.refresh("image.edit");var i=a.offset().left+a.outerWidth()/2,n=a&&xe(a),o=e.$wp&&xe(e.$wp);o||(o=n);var s=0;e.opts.iframe?((s=e.$wp.scrollTop()+t.outerHeight())<a.get(0).getBoundingClientRect().top&&(s=a.get(0).getBoundingClientRect().top),s>a.get(0).getBoundingClientRect().top+a.height()&&(s=a.get(0).getBoundingClientRect().top+a.height())):s=o<n?n:e.$wp&&n+a.height()<o+e.$wp.height()?n+a.height():o+t.outerHeight(),r.hasClass("fr-uploading")?N():e.popups.show("image.edit",i,s,1,!0)}}function Ve(){K()}function Xe(t){0<t.parents(".fr-img-caption").length&&(t=t.parents(".fr-img-caption").first());var a=t.hasClass("fr-dib")?"block":t.hasClass("fr-dii")?"inline":null,i=t.hasClass("fr-fil")?"left":t.hasClass("fr-fir")?"right":ae(t);G(t,a,i),t.removeClass("fr-dib fr-dii fr-fir fr-fil")}function ue(){for(var t,a=e.el.tagName=="IMG"?[e.el]:e.el.querySelectorAll("img"),i=0;i<a.length;i++){var n=f(a[i]);!e.opts.htmlUntouched&&e.opts.useClasses?((e.opts.imageDefaultAlign||e.opts.imageDefaultDisplay)&&(0<(t=n).parents(".fr-img-caption").length&&(t=t.parents(".fr-img-caption").first()),t.hasClass("fr-dii")||t.hasClass("fr-dib")||(t.addClass("fr-fi".concat(ae(t)[0])),t.addClass("fr-di".concat(ye(t)[0])),t.css("margin",""),t.css("float",""),t.css("display",""),t.css("z-index",""),t.css("position",""),t.css("overflow",""),t.css("vertical-align",""))),e.opts.imageTextNear||(0<n.parents(".fr-img-caption").length?n.parents(".fr-img-caption").first().removeClass("fr-dii").addClass("fr-dib"):n.removeClass("fr-dii").addClass("fr-dib"))):e.opts.htmlUntouched||e.opts.useClasses||(e.opts.imageDefaultAlign||e.opts.imageDefaultDisplay)&&Xe(n),e.opts.iframe&&n.on("load",e.size.syncIframe)}}function oe(t){t===void 0&&(t=!0);var a,i=Array.prototype.slice.call(e.el.querySelectorAll("img")),n=[];for(a=0;a<i.length;a++)if(n.push(i[a].getAttribute("src")),f(i[a]).toggleClass("fr-draggable",e.opts.imageMove),i[a].getAttribute("class")===""&&i[a].removeAttribute("class"),i[a].getAttribute("style")===""&&i[a].removeAttribute("style"),i[a].parentNode&&i[a].parentNode.parentNode&&e.node.hasClass(i[a].parentNode.parentNode,"fr-img-caption")){var o=i[a].parentNode.parentNode;e.browser.mozilla||o.setAttribute("contenteditable",!1),o.setAttribute("draggable",!1),o.classList.add("fr-draggable");var s=i[a].nextSibling;s&&!e.browser.mozilla&&s.setAttribute("contenteditable",!0)}if(E)for(a=0;a<E.length;a++)n.indexOf(E[a].getAttribute("src"))<0&&e.events.trigger("image.removed",[f(E[a])]);if(E&&t){var p=[];for(a=0;a<E.length;a++)p.push(E[a].getAttribute("src"));for(a=0;a<i.length;a++)p.indexOf(i[a].getAttribute("src"))<0&&e.events.trigger("image.loaded",[f(i[a])])}E=i}function B(){if(g||function(){var c;if(e.shared.$image_resizer?(g=e.shared.$image_resizer,S=e.shared.$img_overlay,e.events.on("destroy",function(){f("body").first().append(g.removeClass("fr-active"))},!0)):(e.shared.$image_resizer=f(document.createElement("div")).attr("class","fr-image-resizer"),g=e.shared.$image_resizer,e.events.$on(g,"mousedown",function(d){d.stopPropagation()},!0),e.opts.imageResize&&(g.append(se("nw")+se("ne")+se("sw")+se("se")),e.shared.$img_overlay=f(document.createElement("div")).attr("class","fr-image-overlay"),S=e.shared.$img_overlay,c=g.get(0).ownerDocument,f(c).find("body").first().append(S))),e.events.on("shared.destroy",function(){g.html("").removeData().remove(),g=null,e.opts.imageResize&&(S.remove(),S=null)},!0),e.helpers.isMobile()||e.events.$on(f(e.o_win),"resize",function(){r&&!r.hasClass("fr-uploading")?C(!0):r&&(B(),we(),N(!1))}),e.opts.imageResize){c=g.get(0).ownerDocument,e.events.$on(g,e._mousedown,".fr-handler",De),e.events.$on(f(c),e._mousemove,$e),e.events.$on(f(c.defaultView||c.parentWindow),e._mouseup,he),e.events.$on(S,"mouseleave",he);var m=1,u=null,b=0;e.events.on("keydown",function(d){if(r){var v=navigator.userAgent.indexOf("Mac OS X")!=-1?d.metaKey:d.ctrlKey,w=d.which;(w!==u||200<d.timeStamp-b)&&(m=1),(w==l.KEYCODE.EQUALS||e.browser.mozilla&&w==l.KEYCODE.FF_EQUALS)&&v&&!d.altKey?m=Be.call(this,d,1,1,m):(w==l.KEYCODE.HYPHEN||e.browser.mozilla&&w==l.KEYCODE.FF_HYPHEN)&&v&&!d.altKey?m=Be.call(this,d,2,-1,m):e.keys.ctrlKey(d)||w!=l.KEYCODE.ENTER||(r.before("<br>"),U(r)),u=w,b=d.timeStamp}},!0),e.events.on("keyup",function(){m=1})}}(),!r)return!1;var t=e.$wp||e.$sc;t.append(g),g.data("instance",e);var a=t.scrollTop()-(t.css("position")!="static"?t.offset().top:0),i=t.scrollLeft()-(t.css("position")!="static"?t.offset().left:0);i-=e.helpers.getPX(t.css("border-left-width")),a-=e.helpers.getPX(t.css("border-top-width")),e.$el.is("img")&&e.$sc.is("body")&&(i=a=0);var n=R();y()&&(n=n.find(".fr-img-wrap"));var o=0,s=0;e.opts.iframe&&(o=e.helpers.getPX(e.$wp.find(".fr-iframe").css("padding-top")),s=e.helpers.getPX(e.$wp.find(".fr-iframe").css("padding-left"))),g.css("top",(e.opts.iframe?n.offset().top+o:n.offset().top+a)-1).css("left",(e.opts.iframe?n.offset().left+s:n.offset().left+i)-1).css("width",n.get(0).getBoundingClientRect().width).css("height",n.get(0).getBoundingClientRect().height).addClass("fr-active")}function se(t){return'<div class="fr-handler fr-h'.concat(t,'"></div>')}function Z(t){y()&&r.parents(".fr-img-caption").css("width",t),r.css("width",t)}function De(t){if(!e.core.sameInstance(g))return!0;if(t.preventDefault(),t.stopPropagation(),e.$el.find("img.fr-error").left)return!1;e.undo.canDo()||e.undo.saveStep();var a=t.pageX||t.originalEvent.touches[0].pageX;if(t.type=="mousedown"){var i=e.$oel.get(0),n=i.ownerDocument,o=n.defaultView||n.parentWindow,s=!1;try{s=o.location!=o.parent.location&&!(o.$&&o.$.FE)}catch{}s&&o.frameElement&&(a+=e.helpers.getPX(f(i).offset().left)+o.frameElement.clientLeft)}(h=f(this)).data("start-x",a),h.data("start-width",r.width()),h.data("start-height",r.height());var p=r.width();if(e.opts.imageResizeWithPercent){var c=r.parentsUntil(e.$el,e.html.blockTagsQuery()).get(0)||e.el;p=(p/f(c).outerWidth()*100).toFixed(2)+"%"}Z(p),S.show(),e.popups.hideAll(),te()}function $e(t){if(!e.core.sameInstance(g))return!0;var a;if(h&&r){if(t.preventDefault(),e.$el.find("img.fr-error").left)return!1;var i=t.pageX||(t.originalEvent.touches?t.originalEvent.touches[0].pageX:null);if(!i)return!1;var n=i-h.data("start-x"),o=h.data("start-width");if((h.hasClass("fr-hnw")||h.hasClass("fr-hsw"))&&(n=0-n),e.opts.imageResizeWithPercent){var s=r.parentsUntil(e.$el,e.html.blockTagsQuery()).get(0)||e.el;o=((o+n)/f(s).outerWidth()*100).toFixed(2),e.opts.imageRoundPercent&&(o=Math.round(o)),Z("".concat(o,"%")),(a=y()?(e.helpers.getPX(r.parents(".fr-img-caption").css("width"))/f(s).outerWidth()*100).toFixed(2):(e.helpers.getPX(r.css("width"))/f(s).outerWidth()*100).toFixed(2))===o||e.opts.imageRoundPercent||Z("".concat(a,"%")),r.css("height","").removeAttr("height")}else o+n>=e.opts.imageMinWidth&&(Z(o+n),a=y()?e.helpers.getPX(r.parents(".fr-img-caption").css("width")):e.helpers.getPX(r.css("width"))),a!==o+n&&Z(a),((r.attr("style")||"").match(/(^height:)|(; *height:)/)||r.attr("height"))&&(r.css("height",h.data("start-height")*r.width()/h.data("start-width")),r.removeAttr("height"));B(),e.events.trigger("image.resize",[Ce()])}}function he(t){if(!e.core.sameInstance(g))return!0;if(h&&r){if(t&&t.stopPropagation(),e.$el.find("img.fr-error").left)return!1;h=null,S.hide(),B(),j(),e.undo.saveStep(),e.events.trigger("image.resizeEnd",[Ce()])}else g.removeClass("fr-active")}function $(t,a,i){e.edit.on(),r&&r.addClass("fr-error"),I[t]?Te(e.language.translate(I[t])):Te(e.language.translate("Something went wrong. Please try again.")),!r&&i&&pe(i),e.events.trigger("image.error",[{code:t,message:I[t]},a,i])}function ve(t){if(t)return e.$wp&&e.events.$on(e.$wp,"scroll.image-edit",function(){r&&e.popups.isVisible("image.edit")&&(e.events.disableBlur(),j())}),!0;var a="";if(0<e.opts.imageEditButtons.length){var i={buttons:a+=`<div class="fr-buttons">
        `.concat(e.button.buildList(e.opts.imageEditButtons),`
        </div>`)};return e.popups.create("image.edit",i)}return!1}function N(t){var a=e.popups.get("image.insert");if(a||(a=q()),a.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),a.find(".fr-image-progress-bar-layer").addClass("fr-active"),a.find(".fr-buttons").hide(),r){var i=R();e.popups.setContainer("image.insert",e.$sc);var n=i.offset().left,o=i.offset().top+i.height();e.popups.show("image.insert",n,o,i.outerHeight())}t===void 0&&A(e.language.translate("Uploading"),0)}function K(t){var a=e.popups.get("image.insert");if(a&&(a.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),a.find(".fr-image-progress-bar-layer").removeClass("fr-active"),a.find(".fr-buttons").show(),t||e.$el.find("img.fr-error").length)){if(e.events.focus(),e.$el.find("img.fr-error").length&&(e.$el.find("img.fr-error").remove(),e.undo.saveStep(),e.undo.run(),e.undo.dropRedo()),!e.$wp&&r){var i=r;C(!0),e.selection.setAfter(i.get(0)),e.selection.restore()}e.popups.hide("image.insert")}}function A(t,a){var i=e.popups.get("image.insert");if(i){var n=i.find(".fr-image-progress-bar-layer");n.find("h3").text(t+(a?" ".concat(a,"%"):"")),n.removeClass("fr-error"),a?(n.find("div").removeClass("fr-indeterminate"),n.find("div > span").css("width","".concat(a,"%"))):n.find("div").addClass("fr-indeterminate")}}function Te(t){N();var a=e.popups.get("image.insert").find(".fr-image-progress-bar-layer");a.addClass("fr-error");var i=a.find("h3");i.text(t),e.events.disableBlur(),i.focus()}function U(t){Ye.call(t.get(0))}function Ie(){var t=f(this);e.popups.hide("image.insert"),t.removeClass("fr-uploading"),t.next().is("br")&&t.next().remove(),U(t),e.events.trigger("image.loaded",[t])}function ee(t,a,i,n,o){n&&typeof n=="string"&&(n=e.$(n)),e.edit.off(),A(e.language.translate("Loading image")),a&&(t=e.helpers.sanitizeURL(t));var s=new Image;s.onload=function(){var p,c;if(n){e.undo.canDo()||n.hasClass("fr-uploading")||e.undo.saveStep();var m=n.data("fr-old-src");n.data("fr-image-pasted")&&(m=null),e.$wp?((p=n.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted")).off("load"),m&&n.attr("src",m),!e.opts.trackChangesEnabled||n[0].parentNode&&n[0].parentNode.tagName==="SPAN"&&n[0].parentNode.hasAttribute("data-tracking")||e.track_changes.replaceSpecialItem(n),n.replaceWith(p)):p=n;for(var u=p.get(0).attributes,b=0;b<u.length;b++){var d=u[b];(d.nodeName.indexOf("data-")===0||i&&i.hasOwnProperty(d.nodeName))&&p.removeAttr(d.nodeName)}if(i!==void 0)for(c in i)i.hasOwnProperty(c)&&c!="link"&&p.attr("".concat(c),i[c]);p.on("load",Ie),p.attr("src",t),e.edit.on(),oe(!1),n[0].src!=t&&e.selection.restore(),e.undo.saveStep(),e.events.disableBlur(),e.$el.blur(),e.events.trigger(m?"image.replaced":"image.inserted",[p,o])}else(p=Ne(t,i,Ie))&&(oe(!1),e.undo.saveStep(),e.events.disableBlur(),e.$el.blur(),e.events.trigger("image.inserted",[p,o]))},s.onerror=function(){$(V)},N(e.language.translate("Loading image")),s.src=t}function je(t,a,i){A(e.language.translate("Loading image"));var n=this.status,o=this.response,s=this.responseXML,p=this.responseText;try{if(e.opts.imageUploadToS3||e.opts.imageUploadToAzure)if(n==201){var c;if(e.opts.imageUploadToAzure){if(e.events.trigger("image.uploadedToAzure",[this.responseURL,i,o],!0)===!1)return e.edit.on(),!1;c=a}else c=function(b){try{var d=f(b).find("Location").text(),v=f(b).find("Key").text();return e.events.trigger("image.uploadedToS3",[d,v,b],!0)===!1?(e.edit.on(),!1):d}catch{return $(X,b),!1}}(s);c&&ee(c,!1,[],t,o||s)}else $(X,o||s,t);else if(200<=n&&n<300){var m=function(b){try{if(e.events.trigger("image.uploaded",[b],!0)===!1)return e.edit.on(),!1;var d=JSON.parse(b);return d.link?d:($(_,b),!1)}catch{return $(X,b),!1}}(p);m&&ee(m.link,!1,m,t,o||p)}else $(Re,o||p,t)}catch{$(X,o||p,t)}}function qe(){$(X,this.response||this.responseText||this.responseXML)}function Je(t){if(t.lengthComputable){var a=t.loaded/t.total*100|0;A(e.language.translate("Uploading"),a)}}function Ne(t,a,i){var n,o=f(document.createElement("img")).attr("src",t);if(a&&a!==void 0)for(n in a)a.hasOwnProperty(n)&&n!="link"&&(" data-".concat(n,'="').concat(a[n],'"'),o.attr("".concat(n),a[n]));var s=e.opts.imageDefaultWidth;s&&s!="auto"&&(s=e.opts.imageResizeWithPercent?"100%":"".concat(s,"px")),o.attr("style",s?"width: ".concat(s,";"):""),G(o,e.opts.imageDefaultDisplay,e.opts.imageDefaultAlign),o.on("load",i),o.on("error",i),e.edit.on(),e.events.focus(!0),e.selection.restore(),e.undo.saveStep(),e.opts.imageSplitHTML?e.markers.split():e.markers.insert(),e.html.wrap();var p=e.$el.find(".fr-marker");if(p.length)(p.parent().is("hr")||p.parent().is("IMG"))&&p.parent().after(p),e.node.isLastSibling(p)&&p.parent().hasClass("fr-deletable")&&p.insertAfter(p.parent()),p.replaceWith(o);else{if(e.opts.trackChangesEnabled)return K(!0),!1;e.$el.append(o)}return e.selection.clear(),o}function Me(){e.edit.on(),K(!0)}function le(t,a){if(t!==void 0&&0<t.length){if(e.events.trigger("image.beforeUpload",[t,a])===!1)return!1;var i,n=t[0];if(!(e.opts.imageUploadURL!==null&&e.opts.imageUploadURL!=O||e.opts.imageUploadToS3||e.opts.imageUploadToAzure))return function(P,Q){var Y=new FileReader;Y.onload=function(){var x=Y.result;if(Y.result.indexOf("svg+xml")<0){for(var ge=atob(Y.result.split(",")[1]),ce=[],H=0;H<ge.length;H++)ce.push(ge.charCodeAt(H));x=window.URL.createObjectURL(new Blob([new Uint8Array(ce)],{type:P.type})),Q&&Q.data("fr-old-src",Q.attr("src")),e.image.insert(x,!1,null,Q)}else e.image.insert(x,null,null,e.image.get())},N(),Y.readAsDataURL(P)}(n,a||r),!1;if(n.name||(n.name=new Date().getTime()+"."+(n.type||"image/jpeg").replace(/image\//g,"")),n.size>e.opts.imageMaxSize)return $(Ue),!1;if(e.opts.imageAllowedTypes.indexOf(n.type.replace(/image\//g,""))<0)return $(me),!1;if(e.drag_support.formdata&&(i=e.drag_support.formdata?new FormData:null),i){var o;if(e.opts.imageUploadToS3!==!1)for(o in i.append("key",e.opts.imageUploadToS3.keyStart+new Date().getTime()+"-"+(n.name||"untitled")),i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",n.type),e.opts.imageUploadToS3.params)e.opts.imageUploadToS3.params.hasOwnProperty(o)&&i.append(o,e.opts.imageUploadToS3.params[o]);for(o in e.opts.imageUploadParams)e.opts.imageUploadParams.hasOwnProperty(o)&&i.append(o,e.opts.imageUploadParams[o]);i.append(e.opts.imageUploadParam,n,n.name);var s,p,c=e.opts.imageUploadURL,m=e.opts.imageUploadMethod;e.opts.imageUploadToS3&&(c=e.opts.imageUploadToS3.uploadURL?e.opts.imageUploadToS3.uploadURL:"https://".concat(e.opts.imageUploadToS3.region,".amazonaws.com/").concat(e.opts.imageUploadToS3.bucket)),e.opts.imageUploadToAzure&&(s=c=e.opts.imageUploadToAzure.uploadURL?"".concat(e.opts.imageUploadToAzure.uploadURL,"/").concat(n.name):encodeURI("https://".concat(e.opts.imageUploadToAzure.account,".blob.core.windows.net/").concat(e.opts.imageUploadToAzure.container,"/").concat(n.name)),e.opts.imageUploadToAzure.SASToken&&(c+=e.opts.imageUploadToAzure.SASToken),m="PUT");var u=e.core.getXHR(c,m);if(e.opts.imageUploadToAzure){var b=new Date().toUTCString();if(!e.opts.imageUploadToAzure.SASToken&&e.opts.imageUploadToAzure.accessKey){var d=e.opts.imageUploadToAzure.account,v=e.opts.imageUploadToAzure.container;if(e.opts.imageUploadToAzure.uploadURL){var w=e.opts.imageUploadToAzure.uploadURL.split("/");v=w.pop(),d=w.pop().split(".")[0]}var z=`x-ms-blob-type:BlockBlob
x-ms-date:`.concat(b,`
x-ms-version:2019-07-07`),fe=encodeURI("/"+d+"/"+v+"/"+n.name),Se=m+`


`+n.size+`

`+n.type+`






`+z+`
`+fe,ie=e.cryptoJSPlugin.cryptoJS.HmacSHA256(Se,e.cryptoJSPlugin.cryptoJS.enc.Base64.parse(e.opts.imageUploadToAzure.accessKey)).toString(e.cryptoJSPlugin.cryptoJS.enc.Base64),st="SharedKey "+d+":"+ie;p=ie,u.setRequestHeader("Authorization",st)}for(o in u.setRequestHeader("x-ms-version","2019-07-07"),u.setRequestHeader("x-ms-date",b),u.setRequestHeader("Content-Type",n.type),u.setRequestHeader("x-ms-blob-type","BlockBlob"),e.opts.imageUploadParams)e.opts.imageUploadParams.hasOwnProperty(o)&&u.setRequestHeader(o,e.opts.imageUploadParams[o]);for(o in e.opts.imageUploadToAzure.params)e.opts.imageUploadToAzure.params.hasOwnProperty(o)&&u.setRequestHeader(o,e.opts.imageUploadToAzure.params[o])}(function(P,Q,Y,x,ge,ce){function H(){var T=f(this);T.off("load"),T.addClass("fr-uploading"),T.next().is("br")&&T.next().remove(),e.placeholder.refresh(),U(T),B(),N(),e.edit.off(),P.onload=function(){je.call(P,T,ge,ce)},P.onerror=qe,P.upload.onprogress=Je,P.onabort=Me,f(T.off("abortUpload")).on("abortUpload",function(){P.readyState!=4&&(P.abort(),x?(x.attr("src",x.data("fr-old-src")),x.removeClass("fr-uploading")):T.remove(),C(!0))}),P.send(e.opts.imageUploadToAzure?Y:Q)}var ne=new FileReader;ne.onload=function(){var T=ne.result;if(ne.result.indexOf("svg+xml")<0){for(var We=atob(ne.result.split(",")[1]),Ge=[],Ee=0;Ee<We.length;Ee++)Ge.push(We.charCodeAt(Ee));T=window.URL.createObjectURL(new Blob([new Uint8Array(Ge)],{type:"image/jpeg"}))}x?(x.on("load",H),x.on("error",function(){H(),f(this).off("error")}),e.edit.on(),e.undo.saveStep(),x.data("fr-old-src",x.attr("src")),x.attr("src",T)):Ne(T,null,H)},ne.readAsDataURL(Y)})(u,i,n,a||r,s,p)}}}function Qe(t){if(t.is("img")&&0<t.parents(".fr-img-caption").length)return t.parents(".fr-img-caption")}function Ze(t){var a=t.originalEvent.dataTransfer;if(a&&a.files&&a.files.length){var i=a.files[0];if(i&&i.type&&i.type.indexOf("image")!==-1&&0<=e.opts.imageAllowedTypes.indexOf(i.type.replace(/image\//g,""))){if(!e.opts.imageUpload)return t.preventDefault(),t.stopPropagation(),!1;e.markers.remove(),e.markers.insertAtPoint(t.originalEvent),e.$el.find(".fr-marker").replaceWith(l.MARKERS),e.$el.find(".fr-marker").length===0&&e.selection.setAtEnd(e.el),e.popups.hideAll();var n=e.popups.get("image.insert");n||(n=q()),e.popups.setContainer("image.insert",e.$sc);var o=t.originalEvent.pageX,s=t.originalEvent.pageY;if(e.opts.iframe){var p=e.helpers.getPX(e.$wp.find(".fr-iframe").css("padding-top")),c=e.helpers.getPX(e.$wp.find(".fr-iframe").css("padding-left"));s+=e.$iframe.offset().top+p,o+=e.$iframe.offset().left+c}return e.popups.show("image.insert",o,s),N(),0<=e.opts.imageAllowedTypes.indexOf(i.type.replace(/image\//g,""))?(C(!0),le(a.files)):$(me),t.preventDefault(),t.stopPropagation(),!1}}}function q(t){if(t)return e.popups.onRefresh("image.insert",Fe),e.popups.onHide("image.insert",Ve),!0;var a,i,n="";e.opts.imageUpload||e.opts.imageInsertButtons.indexOf("imageUpload")===-1||e.opts.imageInsertButtons.splice(e.opts.imageInsertButtons.indexOf("imageUpload"),1);var o=e.button.buildList(e.opts.imageInsertButtons);o!==""&&(n='<div class="fr-buttons fr-tabs">'.concat(o,"</div>"));var s=e.opts.imageInsertButtons.indexOf("imageUpload"),p=e.opts.imageInsertButtons.indexOf("imageByURL"),c="";0<=s&&(a=" fr-active",0<=p&&p<s&&(a=""),c='<div class="fr-image-upload-layer'.concat(a,' fr-layer" id="fr-image-upload-layer-').concat(e.id,'"><strong>').concat(e.language.translate("Drop image"),"</strong><br>(").concat(e.language.translate("or click"),')<div class="fr-form"><input type="file" accept="image/').concat(e.opts.imageAllowedTypes.join(", image/").toLowerCase(),'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-').concat(e.id,'" role="button"></div></div>'));var m="";0<=p&&(a=" fr-active",0<=s&&s<p&&(a=""),m='<div class="fr-image-by-url-layer'.concat(a,' fr-layer" id="fr-image-by-url-layer-').concat(e.id,'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-').concat(e.id,'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">').concat(e.language.translate("Insert"),"</button></div></div>"));var u={buttons:n,upload_layer:c,by_url_layer:m,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>'};return 1<=e.opts.imageInsertButtons.length&&(i=e.popups.create("image.insert",u)),e.$wp&&e.events.$on(e.$wp,"scroll",function(){r&&e.popups.isVisible("image.insert")&&we()}),function(d){e.events.$on(d,"dragover dragenter",".fr-image-upload-layer",function(v){return f(this).addClass("fr-drop"),(e.browser.msie||e.browser.edge)&&v.preventDefault(),!1},!0),e.events.$on(d,"dragleave dragend",".fr-image-upload-layer",function(v){return f(this).removeClass("fr-drop"),(e.browser.msie||e.browser.edge)&&v.preventDefault(),!1},!0),e.events.$on(d,"drop",".fr-image-upload-layer",function(v){v.preventDefault(),v.stopPropagation(),f(this).removeClass("fr-drop");var w=v.originalEvent.dataTransfer;if(w&&w.files){var z=d.data("instance")||e;z.events.disableBlur(),z.image.upload(w.files),z.events.enableBlur()}},!0),e.helpers.isIOS()&&e.events.$on(d,"touchstart",'.fr-image-upload-layer input[type="file"]',function(){f(this).trigger("click")},!0),e.events.$on(d,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var v=d.data("instance")||e;v.events.disableBlur(),d.find("input:focus").blur(),v.events.enableBlur(),v.image.upload(this.files,r)}f(this).val("")},!0)}(i),i}function Ae(){r&&e.popups.get("image.alt").find("input").val(r.attr("alt")||"").trigger("change")}function Pe(){var t=e.popups.get("image.alt");t||(t=ke()),K(),e.popups.refresh("image.alt"),e.popups.setContainer("image.alt",e.$sc);var a=R(),i=a.outerWidth()/2;y()&&(a=a.find(".fr-img-wrap"),i=r.outerWidth()/2);var n=a.offset().left+i,o=a.offset().top+a.outerHeight(),s=a.outerHeight();e.opts.iframe&&y()&&(s=r?r.outerHeight():0),e.popups.show("image.alt",n,o,s,!0)}function ke(t){if(t)return e.popups.onRefresh("image.alt",Ae),!0;var a={buttons:'<div class="fr-buttons fr-tabs">'.concat(e.button.buildList(e.opts.imageAltButtons),"</div>"),alt_layer:'<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'.concat(e.id,'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-').concat(e.id,'" type="text" placeholder="').concat(e.language.translate("Alternative Text"),'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">').concat(e.language.translate("Update"),"</button></div></div>")},i=e.popups.create("image.alt",a);return e.$wp&&e.events.$on(e.$wp,"scroll.image-alt",function(){r&&e.popups.isVisible("image.alt")&&Pe()}),i}function et(){var t=e.popups.get("image.size"),a=r.get(0).style.height?r.get(0).style.height:"auto",i=r.get(0).style.width?r.get(0).style.width:"auto";if(r)if(y()){var n=r.parent();n.get(0).style.width||(n=r.parent().parent()),t.find('input[name="width"]').val(i).trigger("change"),t.find('input[name="height"]').val(a).trigger("change")}else t.find('input[name="width"]').val(i).trigger("change"),t.find('input[name="height"]').val(a).trigger("change")}function Oe(){var t=e.popups.get("image.size");t||(t=_e()),K(),e.popups.refresh("image.size"),e.popups.setContainer("image.size",e.$sc);var a=R(),i=a.outerWidth()/2;y()&&(a=a.find(".fr-img-wrap"),i=r.outerWidth()/2);var n=a.outerHeight();e.opts.iframe&&y()&&(n=r?r.outerHeight():0);var o=a.offset().left+i,s=a.offset().top+a.outerHeight();e.popups.show("image.size",o,s,n,!0)}function _e(t){if(t)return e.popups.onRefresh("image.size",et),!0;var a={buttons:'<div class="fr-buttons fr-tabs">'.concat(e.button.buildList(e.opts.imageSizeButtons),"</div>"),size_layer:'<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'.concat(e.id,`"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'`).concat(e.id,'" type="text" name="width" placeholder="').concat(e.language.translate("Width"),'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height').concat(e.id,'" type="text" name="height" placeholder="').concat(e.language.translate("Height"),'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">').concat(e.language.translate("Update"),"</button></div></div>")},i=e.popups.create("image.size",a);return e.$wp&&e.events.$on(e.$wp,"scroll.image-size",function(){r&&e.popups.isVisible("image.size")&&Oe()}),i}function Be(t,a,i,n){return t.pageX=a,De.call(this,t),t.pageX=t.pageX+i*Math.floor(Math.pow(1.1,n)),$e.call(this,t),he.call(this,t),++n}function pe(t){if(t=t||R(),e.opts.trackChangesEnabled&&!e.helpers.isMobile()&&(!t[0].parentNode||t[0].parentNode.tagName!=="SPAN"||!t[0].parentNode.hasAttribute("data-tracking")))return e.track_changes.removeSpecialItem(t),e.popups.hideAll(),void C(!0);t&&e.events.trigger("image.beforeRemove",[t])!==!1&&(e.popups.hideAll(),J(),C(!0),e.undo.canDo()||e.undo.saveStep(),t.get(0)==e.el?t.removeAttr("src"):(t.get(0).parentNode&&t.get(0).parentNode.tagName=="A"?(e.selection.setBefore(t.get(0).parentNode)||e.selection.setAfter(t.get(0).parentNode)||t.parent().after(l.MARKERS),f(t.get(0).parentNode).remove()):(e.selection.setBefore(t.get(0))||e.selection.setAfter(t.get(0))||t.after(l.MARKERS),t.remove()),e.html.fillEmptyBlocks(),e.selection.restore()),e.undo.saveStep())}function ze(t){var a=t.which,i=document.getElementsByClassName("fs-transforms-container"),n=!1;if(i&&i.length){var o,s=L(i);try{for(s.s();!(o=s.n()).done;){var p=o.value;p.childNodes&&p.childNodes.length&&(n=!0)}}catch(u){s.e(u)}finally{s.f()}}if(n&&(r=null),r&&(a==l.KEYCODE.BACKSPACE||a==l.KEYCODE.DELETE))return t.preventDefault(),t.stopPropagation(),pe(),!1;if(r&&a==l.KEYCODE.ESC){var c=r;return C(!0),e.selection.setAfter(c.get(0)),e.selection.restore(),t.preventDefault(),!1}if(!r||a!=l.KEYCODE.ARROW_LEFT&&a!=l.KEYCODE.ARROW_RIGHT)return r&&a===l.KEYCODE.TAB?(t.preventDefault(),t.stopPropagation(),C(!0),!1):r&&a!=l.KEYCODE.F10&&!e.keys.isBrowserAction(t)?(t.preventDefault(),t.stopPropagation(),!1):void 0;var m=r.get(0);return C(!0),a==l.KEYCODE.ARROW_LEFT?e.selection.setBefore(m):e.selection.setAfter(m),e.selection.restore(),t.preventDefault(),!1}function Le(t){if(t&&t.tagName=="IMG"){if(e.node.hasClass(t,"fr-uploading")||e.node.hasClass(t,"fr-error")?t.parentNode.removeChild(t):e.node.hasClass(t,"fr-draggable")&&t.classList.remove("fr-draggable"),t.parentNode&&t.parentNode.parentNode&&e.node.hasClass(t.parentNode.parentNode,"fr-img-caption")){var a=t.parentNode.parentNode;a.removeAttribute("contenteditable"),a.removeAttribute("draggable"),a.classList.remove("fr-draggable");var i=t.nextSibling;i&&i.removeAttribute("contenteditable")}}else if(t&&t.nodeType==Node.ELEMENT_NODE)for(var n=t.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"),o=0;o<n.length;o++)Le(n[o])}function Ke(t){if(e.events.trigger("image.beforePasteUpload",[t])===!1)return f(t).removeAttr("data-fr-image-pasted"),!1;r=f(t),B(),j(),N(),r.on("load",function(){var s=[];B(),f(e.popups.get("image.insert").get(0)).find("div.fr-active.fr-error").length<1&&N(),f(this).data("events").filter(function(p){p[0]==="load"&&s.push(p)}),s.length<=1&&f(this).off("load")});for(var a=f(t).attr("src").split(","),i=atob(a[1]),n=[],o=0;o<i.length;o++)n.push(i.charCodeAt(o));le([e.browser.safari&&!e.opts.imageUploadURL?new Blob([new Uint8Array(n)],{type:a[0].replace(/data\:/g,"")}):new Blob([new Uint8Array(n)],{type:a[0].replace(/data\:/g,"").replace(/;base64/g,"")})],r)}function tt(){e.opts.imagePaste?e.$el.find("img[data-fr-image-pasted]").each(function(t,a){if(e.opts.imagePasteProcess){var i=e.opts.imageDefaultWidth;i&&i!="auto"&&(i+=e.opts.imageResizeWithPercent?"%":"px"),f(a).css("width",i).removeClass("fr-dii fr-dib fr-fir fr-fil"),G(f(a),e.opts.imageDefaultDisplay,e.opts.imageDefaultAlign)}if(a.src.indexOf("data:")===0)Ke(a);else if(a.src.indexOf("blob:")===0||a.src.indexOf("http")===0&&e.opts.imageUploadRemoteUrls&&e.opts.imageCORSProxy){var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var o=e.o_doc.createElement("CANVAS"),s=o.getContext("2d");o.height=this.naturalHeight,o.width=this.naturalWidth,s.drawImage(this,0,0),setTimeout(function(){Ke(a)},0),a.src=o.toDataURL(l.IMAGE_TYPE)},e.browser.msie&&l.IMAGE_ALLOW_REGEX.test(a.src)&&(l.IMAGE_TYPE="image/"+a.src.split(l.IMAGE_ALLOW_REGEX)[1]),n.src=(a.src.indexOf("blob:")===0?"":"".concat(e.opts.imageCORSProxy,"/"))+a.src,a.src.indexOf("blob:")!==0&&e.undo.saveStep()}else a.src.indexOf("http")!==0||a.src.indexOf("https://mail.google.com/mail")===0?(e.selection.save(),f(a).remove(),e.selection.restore()):f(a).removeAttr("data-fr-image-pasted")}):e.$el.find("img[data-fr-image-pasted]").remove()}function at(t){var a=t.target.result,i=e.opts.imageDefaultWidth;i&&i!="auto"&&(i+=e.opts.imageResizeWithPercent?"%":"px"),e.undo.saveStep(),e.html.insert('<img data-fr-image-pasted="true" src="'.concat(a,'"').concat(i?' style="width: '.concat(i,';"'):"",">"));var n=e.$el.find('img[data-fr-image-pasted="true"]');n&&G(n,e.opts.imageDefaultDisplay,e.opts.imageDefaultAlign),e.events.trigger("paste.after")}function it(t,a){var i=new FileReader;i.onload=function(o){var s=e.opts.imageDefaultWidth;s&&s!="auto"&&(s+=e.opts.imageResizeWithPercent?"%":"px"),e.html.insert('<img data-fr-image-pasted="true" src="'.concat(o,'"').concat(s?' style="width: '.concat(s,';"'):"",">"));var p=e.$el.find('img[data-fr-image-pasted="true"]');p&&G(p,e.opts.imageDefaultDisplay,e.opts.imageDefaultAlign),e.events.trigger("paste.after")}(a),i.readAsDataURL(t,a)}function nt(t,a){var i=a||t&&t.clipboardData;if(i&&i.items){var n=(i||window.clipboardData).getData("text/html")||"";e.browser.mozilla&&(n===""||/<!--StartFragment-->([ ])<!--EndFragment-->/.test(n))&&(n=e.win.localStorage.getItem("fr-copied-html"));var o=new DOMParser().parseFromString(n,"text/html").querySelector("img");if(o&&!e.opts.imageUploadURL){if(!o)return!1;var s=o.src,p=null;if(i.types&&[].indexOf.call(i.types,"text/rtf")!=-1||i.getData("text/rtf"))p=i.items[0].getAsFile();else for(var c=0;c<i.items.length;c++)if(p=i.items[c].getAsFile()){l.IMAGE_TYPE=p.type;break}if(p)return it(p,s),!1}else{var m=null;if(i.types&&[].indexOf.call(i.types,"text/rtf")!=-1||i.getData("text/rtf"))m=i.items[0].getAsFile();else for(var u=0;u<i.items.length&&!(m=i.items[u].getAsFile());u++);if(m)return function(d){var v=new FileReader;v.onload=at,v.readAsDataURL(d)}(m),!1}}}function rt(t){return t=t.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function Ye(t){if(f(this).parents("[contenteditable]").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")=="false"||t&&t.type=="touchend"&&F)return!0;if(t&&e.edit.isDisabled())return t.stopPropagation(),t.preventDefault(),!1;for(var a=0;a<l.INSTANCES.length;a++)l.INSTANCES[a]!=e&&l.INSTANCES[a].events.trigger("image.hideResizer");e.toolbar.disable(),t&&(t.stopPropagation(),t.preventDefault()),e.helpers.isMobile()&&(e.events.disableBlur(),e.$el.blur(),e.events.enableBlur()),e.opts.iframe&&e.size.syncIframe(),r=f(this),J(),B(),j(),e.browser.msie?(e.popups.areVisible()&&e.events.disableBlur(),e.win.getSelection&&(e.win.getSelection().removeAllRanges(),e.win.getSelection().addRange(e.doc.createRange()))):e.selection.clear(),e.helpers.isIOS()&&(e.events.disableBlur(),e.$el.blur()),e.button.bulkRefresh(),e.events.trigger("video.hideResizer")}function C(t){r&&(function(){return be}()||t===!0)&&(e.toolbar.enable(),g.removeClass("fr-active"),e.popups.hideAll(),r=null,te(),h=null,S&&S.hide())}I[V]="Image cannot be loaded from the passed link.",I[_]="No link in upload response.",I[Re]="Error during file upload.",I[X]="Parsing response failed.",I[Ue]="File is too large.",I[me]="Image file type is invalid.",I[7]="Files can be uploaded only to same domain in IE 8 and IE 9.";var be=!(I[8]="Image file is corrupted.");function ot(){be=!0}function te(){be=!1}function G(t,a,i){if(!e.opts.htmlUntouched&&e.opts.useClasses)t.removeClass("fr-fil fr-fir fr-dib fr-dii"),i&&t.addClass("fr-fi".concat(i[0])),a&&t.addClass("fr-di".concat(a[0]));else if(a=="inline")if(t.css({display:"inline-block",verticalAlign:"bottom",margin:e.opts.imageDefaultMargin}),i=="center")t.css({float:"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - ".concat(2*e.opts.imageDefaultMargin,"px)"),textAlign:"center"});else if(i=="left"){var n="0px",o=t.parent("span.fr-img-caption").get(0);o||(o=t.parent().get(0)),o&&o.tagName.toLowerCase()==="li"?n="20px":o&&o.tagName.toLowerCase()==="p"&&(n="15px"),t.css({float:"left",marginLeft:0,maxWidth:"calc(100% - ".concat(e.opts.imageDefaultMargin,"px)"),textAlign:"left",marginRight:n})}else t.css({float:"right",marginRight:0,maxWidth:"calc(100% - ".concat(e.opts.imageDefaultMargin,"px)"),textAlign:"right"});else a=="block"&&(t.css({display:"block",float:"none",verticalAlign:"top",margin:"".concat(e.opts.imageDefaultMargin,"px auto"),textAlign:"center"}),i=="left"?t.css({marginLeft:0,textAlign:"left"}):i=="right"&&t.css({marginRight:0,textAlign:"right"}))}function ae(t){if(t===void 0&&(t=R()),t){if(t.hasClass("fr-fil"))return"left";if(t.hasClass("fr-fir"))return"right";if(t.hasClass("fr-dib")||t.hasClass("fr-dii"))return"center";var a=t.css("float");if(t.css("float","none"),t.css("display")=="block"){if(t.css("float",""),t.css("float")!=a&&t.css("float",a),parseInt(t.css("margin-left"),10)===0)return"left";if(parseInt(t.css("margin-right"),10)===0)return"right"}else{if(t.css("float",""),t.css("float")!=a&&t.css("float",a),t.css("float")=="left")return"left";if(t.css("float")=="right")return"right"}}return"center"}function ye(t){t===void 0&&(t=R());var a=t.css("float");return t.css("float","none"),t.css("display")=="block"?(t.css("float",""),t.css("float")!=a&&t.css("float",a),"block"):(t.css("float",""),t.css("float")!=a&&t.css("float",a),"inline")}function we(){var t=e.popups.get("image.insert");t||(t=q()),e.popups.isVisible("image.insert")||(K(),e.popups.refresh("image.insert"),e.popups.setContainer("image.insert",e.$sc));var a=R(),i=a&&a.outerWidth()/2;y()&&(a=a.find(".fr-img-wrap"),i=r.outerWidth()/2);var n,o=a.offset().left+i,s=a.outerHeight(!0);e.opts.iframe&&y()&&(s=r?r.outerHeight():0),n=0<e.$el.find("img[data-fr-image-pasted]").length?e.$wp.offset().top-e.helpers.scrollTop()+e.$wp.height():a.offset().top+a.outerHeight(),e.popups.show("image.insert",o,n,s,!0)}function J(){if(r){e.events.disableBlur(),e.selection.clear();var t=e.doc.createRange();t.selectNode(r.get(0)),e.browser.msie&&t.collapse(!0),e.selection.get().addRange(t),e.events.enableBlur()}}function Ce(){return r}function R(){return y()?r.parents(".fr-img-caption").first():r}function y(){return!!r&&0<r.parents(".fr-img-caption").length}function M(t){for(var a=document.createDocumentFragment();t.firstChild;){var i=t.removeChild(t.firstChild);a.appendChild(i)}t.parentNode.replaceChild(a,t)}return{_init:function(){var a;(function(){e.events.$on(e.$el,e._mousedown,e.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(n){if(f(this).parents("contenteditable").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")=="false")return!0;e.helpers.isMobile()||e.selection.clear(),D=!0,e.popups.areVisible()&&e.events.disableBlur(),e.browser.msie&&(e.events.disableBlur(),e.$el.attr("contenteditable",!1)),e.draggable||n.type=="touchstart"||n.preventDefault(),n.stopPropagation()}),e.events.$on(e.$el,e._mousedown,".fr-img-caption .fr-inner",function(n){e.core.hasFocus()||e.events.focus(),n.stopPropagation()}),e.events.$on(e.$el,"paste",".fr-img-caption .fr-inner",function(n){e.opts.toolbarInline===!0&&(e.toolbar.hide(),n.stopPropagation())}),e.events.$on(e.$el,e._mousedown,'img:not([contenteditable="false"])',function(n){var o=this;e.browser.mozilla&&n.which==3&&(f(this).attr("contenteditable",!1),setTimeout(function(){f(o).removeAttr("contenteditable")},200))}),e.events.$on(e.$el,e._mouseup,e.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(n){if(f(this).parents("contenteditable").not(".fr-element").not(".fr-img-caption").not("body").first().attr("contenteditable")=="false")return!0;D&&(D=!1,n.stopPropagation(),e.browser.msie&&(e.$el.attr("contenteditable",!0),e.events.enableBlur()))}),e.events.on("keyup",function(n){if(n.shiftKey&&e.selection.text().replace(/\n/g,"")===""&&e.keys.isArrow(n.which)){var o=e.selection.element(),s=e.selection.endElement();o&&o.tagName=="IMG"?U(f(o)):s&&s.tagName=="IMG"&&U(f(s))}},!0),e.events.on("drop",Ze),e.events.on("element.beforeDrop",Qe),e.events.on("mousedown window.mousedown",ot),e.events.on("window.touchmove",te),e.events.on("mouseup window.mouseup",function(){if(r&&!e.helpers.isMobile())return C(),!1;te()}),e.events.on("touchstart touchend",function(){if(r&&e.helpers.isMobile())return C(),!1;te()}),e.events.on("commands.mousedown",function(n){0<n.parents(".fr-toolbar").length&&C()}),e.events.on("image.resizeEnd",function(){e.opts.iframe&&e.size.syncIframe()}),e.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){C(!(D=!1))}),e.events.on("modals.hide",function(){r&&(J(),e.selection.clear())}),e.events.on("image.resizeEnd",function(){e.win.getSelection&&U(r)}),e.events.on("filestack-init",function(){q()}),e.events.on("filestack-init-edit",function(){for(var n=e.$(".fr-popup"),o=n.length-1;0<=o;o--)n[o].parentElement.removeChild(n[o]);ve()}),e.opts.imageAddNewLine&&e.events.on("image.inserted",function(n){var o=n.get(0);for(o.nextSibling&&o.nextSibling.tagName==="BR"&&(o=o.nextSibling);o&&!e.node.isElement(o);)o=e.node.isLastSibling(o)?o.parentNode:null;e.node.isElement(o)&&(e.opts.enter===l.ENTER_BR?n.after("<br>"):f(e.node.blockParent(n.get(0))).after("<".concat(e.html.defaultTag(),"><br></").concat(e.html.defaultTag(),">")))})})(),e.el.tagName=="IMG"&&e.$el.addClass("fr-view"),e.events.$on(e.$el,e.helpers.isMobile()&&!e.helpers.isWindowsPhone()?"touchend":"click",e.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',Ye),e.helpers.isMobile()&&(e.events.$on(e.$el,"touchstart",e.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(){F=!1}),e.events.$on(e.$el,"touchmove",function(){F=!0})),e.$wp?(e.events.on("window.keydown keydown",ze,!0),e.events.on("keyup",function(i){if(r&&i.which==l.KEYCODE.ENTER)return!1},!0),e.events.$on(e.$el,"keydown",function(){var i=e.selection.element();(i.nodeType===Node.TEXT_NODE||i.tagName=="BR"&&e.node.isLastSibling(i))&&(i=i.parentNode),e.node.hasClass(i,"fr-inner")||(e.node.hasClass(i,"fr-img-caption")||(i=f(i).parents(".fr-img-caption").get(0)),e.node.hasClass(i,"fr-img-caption")&&(e.opts.trackChangesEnabled||f(i).after(l.INVISIBLE_SPACE+l.MARKERS),e.selection.restore()))})):e.events.$on(e.$win,"keydown",ze),e.events.on("toolbar.esc",function(){if(r){if(e.$wp)e.events.disableBlur(),e.events.focus();else{var i=r;C(!0),e.selection.setAfter(i.get(0)),e.selection.restore()}return!1}},!0),e.events.on("toolbar.focusEditor",function(){if(r)return!1},!0),e.events.on("window.cut window.copy",function(i){if(r&&e.popups.isVisible("image.edit")&&!e.popups.get("image.edit").find(":focus").length){var n=R();y()?(n.before(l.START_MARKER),n.after(l.END_MARKER),e.selection.restore(),e.paste.saveCopiedText(n.get(0).outerHTML,n.text())):(J(),e.paste.saveCopiedText(r.get(0).outerHTML,r.attr("alt"))),i.type=="copy"?setTimeout(function(){U(r)}):(C(!0),e.undo.saveStep(),setTimeout(function(){e.undo.saveStep()},0))}},!0),e.browser.msie&&e.events.on("keydown",function(i){if(!e.selection.isCollapsed()||!r)return!0;var n=i.which;n==l.KEYCODE.C&&e.keys.ctrlKey(i)?e.events.trigger("window.copy"):n==l.KEYCODE.X&&e.keys.ctrlKey(i)&&e.events.trigger("window.cut")}),e.events.$on(f(e.o_win),"keydown",function(i){if(e.opts.pluginsEnabled.includes("filestack")&&e.opts.iframe){var n=document.getElementsByClassName("fs-transforms-container"),o=!1;if(n&&n.length){var s,p=L(n);try{for(p.s();!(s=p.n()).done;){var c=s.value;c.childNodes&&c.childNodes.length&&(o=!0)}}catch(u){p.e(u)}finally{p.f()}}o&&(r=null)}var m=i.which;if(r&&m==l.KEYCODE.BACKSPACE)return i.preventDefault(),!1}),e.events.$on(e.$win,"keydown",function(i){var n=i.which;r&&r.hasClass("fr-uploading")&&n==l.KEYCODE.ESC&&r.trigger("abortUpload")}),e.events.on("destroy",function(){r&&r.hasClass("fr-uploading")&&r.trigger("abortUpload")}),e.events.on("paste.before",nt),e.events.on("paste.beforeCleanup",rt),e.events.on("paste.after",tt),e.events.on("html.set",ue),e.events.on("html.inserted",ue),ue(),e.events.on("destroy",function(){E=[]}),e.events.on("html.processGet",Le),e.opts.imageOutputSize&&e.events.on("html.beforeGet",function(){a=e.el.querySelectorAll("img");for(var i=0;i<a.length;i++){var n=parseFloat(f(a[i]).css("padding-left"))+parseFloat(f(a[i]).css("padding-right")),o=f(a[i]).width()-n,s=a[i].style.width||o,p=a[i].style.height||f(a[i]).height();s&&a[i].setAttribute("width","".concat(s).replace(/px/,"")),p&&a[i].setAttribute("height","".concat(p).replace(/px/,""))}}),e.opts.iframe&&e.events.on("image.loaded",e.size.syncIframe),e.$wp&&(oe(),e.events.on("contentChanged",oe)),e.events.$on(f(e.o_win),"orientationchange.image",function(){setTimeout(function(){r&&U(r)},100)}),ve(!0),q(!0),_e(!0),ke(!0),e.events.on("node.remove",function(i){if(i.get(0).tagName=="IMG")return pe(i),!1})},showInsertPopup:function(){var a=e.$tb.find('.fr-command[data-cmd="insertImage"]'),i=e.popups.get("image.insert");if(i||(i=q()),K(),!i.hasClass("fr-active"))if(e.popups.refresh("image.insert"),e.popups.setContainer("image.insert",e.$tb),a.isVisible()){var n=e.button.getPosition(a),o=n.left,s=n.top;e.popups.show("image.insert",o,s,a.outerHeight())}else e.position.forSelection(i),e.popups.show("image.insert")},showLayer:function(a){var i,n,o=e.popups.get("image.insert");if(r||e.opts.toolbarInline){if(r){var s=R(),p=0;y()&&(s=s.find(".fr-img-wrap"),p=r.outerWidth()/2),n=s.offset().top+s.outerHeight(),i=s.offset().left+p}}else{var c=e.$tb.find('.fr-command[data-cmd="insertImage"]');i=c.offset().left,n=c.offset().top+(e.opts.toolbarBottom?10:c.outerHeight()-10)}!r&&e.opts.toolbarInline&&(n=o.offset().top-e.helpers.getPX(o.css("margin-top")),o.hasClass("fr-above")&&(n+=o.outerHeight())),o.find(".fr-layer").removeClass("fr-active"),o.find(".fr-".concat(a,"-layer")).addClass("fr-active"),e.popups.show("image.insert",i,n,r?r.outerHeight():0,y()),e.accessibility.focusPopup(o)},refreshUploadButton:function(a){var i=e.popups.get("image.insert");i&&i.find(".fr-image-upload-layer").hasClass("fr-active")&&a.addClass("fr-active").attr("aria-pressed",!0)},refreshByURLButton:function(a){var i=e.popups.get("image.insert");i&&i.find(".fr-image-by-url-layer").hasClass("fr-active")&&a.addClass("fr-active").attr("aria-pressed",!0)},upload:le,insertByURL:function(){var a=e.popups.get("image.insert").find(".fr-image-by-url-layer input");if(0<a.val().length){N(),A(e.language.translate("Loading image"));var i=a.val().trim();if(e.opts.imageUploadRemoteUrls&&e.opts.imageCORSProxy&&e.opts.imageUpload){var n=new XMLHttpRequest;n.onload=function(){this.status==200?le([new Blob([this.response],{type:this.response.type||"image/png"})],r):$(V)},n.onerror=function(){ee(i,!0,[],r)},n.open("GET","".concat(e.opts.imageCORSProxy,"/").concat(i),!0),n.responseType="blob",n.send()}else ee(i,!0,[],r);a.val(""),a.blur()}},align:function(a){var i=R();i.removeClass("fr-fir fr-fil"),!e.opts.htmlUntouched&&e.opts.useClasses?a=="left"?i.addClass("fr-fil"):a=="right"&&i.addClass("fr-fir"):G(i,ye(),a),J(),B(),j(),e.selection.clear()},refreshAlign:function(a){r&&a.find("> *").first().replaceWith(e.icon.create("image-align-".concat(ae())))},refreshAlignOnShow:function(a,i){r&&i.find('.fr-command[data-param1="'.concat(ae(),'"]')).addClass("fr-active").attr("aria-selected",!0)},display:function(a){var i=R();i.removeClass("fr-dii fr-dib"),!e.opts.htmlUntouched&&e.opts.useClasses?a=="inline"?i.addClass("fr-dii"):a=="block"&&i.addClass("fr-dib"):G(i,a,ae()),J(),B(),j(),e.selection.clear()},refreshDisplayOnShow:function(a,i){r&&i.find('.fr-command[data-param1="'.concat(ye(),'"]')).addClass("fr-active").attr("aria-selected",!0)},replace:we,back:function(){r?(e.events.disableBlur(),f(".fr-popup input:focus").blur(),U(r)):(e.events.disableBlur(),e.selection.restore(),e.events.enableBlur(),e.popups.hide("image.insert"),e.toolbar.showInline())},get:Ce,getEl:R,insert:ee,showProgressBar:N,remove:pe,hideProgressBar:K,applyStyle:function(a,i,n){if(i===void 0&&(i=e.opts.imageStyles),n===void 0&&(n=e.opts.imageMultipleStyles),!r)return!1;var o=R();if(!n){var s=Object.keys(i);s.splice(s.indexOf(a),1),o.removeClass(s.join(" "))}W(i[a])=="object"?(o.removeAttr("style"),o.css(i[a].style)):(o.toggleClass(a),y()&&r.hasClass(a)&&r.removeClass(a)),U(r)},showAltPopup:Pe,showSizePopup:Oe,setAlt:function(a){if(r){var i=e.popups.get("image.alt");r.attr("alt",a||i.find("input").val()||""),i.find("input:focus").blur(),U(r)}},setSize:function(a,i){if(r){var n=e.popups.get("image.size");a=a||n.find('input[name="width"]').val()||"",i=i||n.find('input[name="height"]').val()||"";var o=/^[\d]+((px)|%)*$/g;r.removeAttr("width").removeAttr("height"),a.match(o)?r.css("width",a):r.css("width",""),i.match(o)?r.css("height",i):r.css("height",""),y()&&(r.parents(".fr-img-caption").removeAttr("width").removeAttr("height"),a.match(o)?r.parents(".fr-img-caption").css("width",a):r.parents(".fr-img-caption").css("width",""),i.match(o)?r.parents(".fr-img-caption").css("height",i):r.parents(".fr-img-caption").css("height","")),n&&n.find("input:focus").blur(),U(r)}},toggleCaption:function(){var a,i=e.$el.get(0);if(r&&!y()){(a=r).parent().is("a")&&(a=r.parent());var n,o,s=r.parents("ul")&&0<r.parents("ul").length?r.parents("ul"):r.parents("ol")&&0<r.parents("ol").length?r.parents("ol"):[];if(0<s.length){var p=s.find("li").length,c=r.parents("li"),m=document.createElement("li");p-1===c.index()&&(s.append(m),m.innerHTML="&nbsp;")}a.attr("style")?o=-1<(n=a.attr("style").split(":")).indexOf("width")?n[n.indexOf("width")+1].replace(";",""):"":a.attr("width")&&(o=a.attr("width"));var u=e.opts.imageResizeWithPercent?(-1<o.indexOf("px")?null:o)||"100%":r.width()+"px";a.wrap('<div class="fr-img-space-wrap"><span '+(e.browser.mozilla?"":'contenteditable="false"')+'class="fr-img-caption '+r.attr("class")+'" style="'+(e.opts.useClasses?"":a.attr("style"))+'" draggable="false"></span></div>'),a.wrap('<span class="fr-img-wrap"></span>'),r.after('<span class="fr-inner"'.concat(e.browser.mozilla?"":' contenteditable="true"',">").concat(l.START_MARKER).concat(e.language.translate("Image Caption")).concat(l.END_MARKER,"</span>")),r.parents(".fr-img-caption").css("width",u);var b=r.parents(".fr-img-space-wrap").length;b==1?M(i.querySelector(".fr-img-space-wrap")):1<b&&(M(i.querySelector(".fr-img-space-wrap")),M(i.querySelector(".fr-img-space-wrap2"))),C(!0),e.selection.restore()}else{if(a=R(),r.insertBefore(a),a[0].querySelector("a")!==null){for(var d,v=a[0].querySelector("a"),w=document.createElement("a"),z=0,fe=v.attributes,Se=fe.length;z<Se;z++)d=fe[z],w.setAttribute(d.nodeName,d.nodeValue);r.wrap(w)}r.attr("class",a.attr("class").replace("fr-img-caption","")).attr("style",a.attr("style")),a.remove();var ie=r.parents(".fr-img-space-wrap").length;ie==1?M(i.querySelector(".fr-img-space-wrap")):1<ie&&(M(i.querySelector(".fr-img-space-wrap")),M(i.querySelector(".fr-img-space-wrap2"))),U(r)}},hasCaption:y,exitEdit:C,edit:U}},l.DefineIcon("insertImage",{NAME:"image",SVG_KEY:"insertImage"}),l.RegisterShortcut(l.KEYCODE.P,"insertImage",null,"P"),l.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),l.DefineIcon("imageUpload",{NAME:"upload",SVG_KEY:"upload"}),l.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(e){this.image.refreshUploadButton(e)}}),l.DefineIcon("imageByURL",{NAME:"link",SVG_KEY:"insertLink"}),l.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(e){this.image.refreshByURLButton(e)}}),l.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(e){this.image.get()?e.text(this.language.translate("Replace")):e.text(this.language.translate("Insert"))}}),l.DefineIcon("imageDisplay",{NAME:"star",SVG_KEY:"imageDisplay"}),l.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,r){this.image.display(r)},refresh:function(e){this.opts.imageTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,r){this.image.refreshDisplayOnShow(e,r)}}),l.DefineIcon("image-align",{NAME:"align-left",SVG_KEY:"alignLeft"}),l.DefineIcon("image-align-left",{NAME:"align-left",SVG_KEY:"alignLeft"}),l.DefineIcon("image-align-right",{NAME:"align-right",SVG_KEY:"alignRight"}),l.DefineIcon("image-align-center",{NAME:"align-justify",SVG_KEY:"alignCenter"}),l.DefineIcon("imageAlign",{NAME:"align-justify",SVG_KEY:"alignJustify"}),l.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',r=l.COMMANDS.imageAlign.options;for(var g in r)r.hasOwnProperty(g)&&(e+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'.concat(g,'" title="').concat(this.language.translate(r[g]),'">').concat(this.icon.create("image-align-".concat(g)),'<span class="fr-sr-only">').concat(this.language.translate(r[g]),"</span></a></li>"));return e+="</ul>"},callback:function(e,r){this.image.align(r)},refresh:function(e){this.image.refreshAlign(e)},refreshOnShow:function(e,r){this.image.refreshAlignOnShow(e,r)}}),l.DefineIcon("imageReplace",{NAME:"exchange",FA5NAME:"exchange-alt",SVG_KEY:"replaceImage"}),l.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),l.DefineIcon("imageRemove",{NAME:"trash",SVG_KEY:"remove"}),l.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),l.DefineIcon("imageBack",{NAME:"arrow-left",SVG_KEY:"back"}),l.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(e){this.$,this.image.get()||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),l.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),l.DefineIcon("imageStyle",{NAME:"magic",SVG_KEY:"imageClass"}),l.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',r=this.opts.imageStyles;for(var g in r)if(r.hasOwnProperty(g)){var h=r[g];W(h)=="object"&&(h=h.title),e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'.concat(g,'">').concat(this.language.translate(h),"</a></li>")}return e+="</ul>"},callback:function(e,r){this.image.applyStyle(r)},refreshOnShow:function(e,r){var g=this.$,h=this.image.getEl();h&&r.find(".fr-command").each(function(){var S=g(this).data("param1"),E=h.hasClass(S);g(this).toggleClass("fr-active",E).attr("aria-selected",E)})}}),l.DefineIcon("imageAlt",{NAME:"info",SVG_KEY:"imageAltText"}),l.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternative Text",callback:function(){this.image.showAltPopup()}}),l.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),l.DefineIcon("imageSize",{NAME:"arrows-alt",SVG_KEY:"imageSize"}),l.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}}),l.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}}),l.DefineIcon("imageCaption",{NAME:"commenting",FA5NAME:"comment-alt",SVG_KEY:"imageCaption"}),l.RegisterCommand("imageCaption",{undo:!0,focus:!1,title:"Image Caption",refreshAfterCallback:!0,callback:function(){this.image.toggleCaption()},refresh:function(e){this.image.get()&&e.toggleClass("fr-active",this.image.hasCaption())}})})})();var He=dt.exports;const mt=pt(He),vt=ct({__proto__:null,default:mt},[He]);export{vt as i};
